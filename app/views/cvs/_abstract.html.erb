<%# locals: (cv:, change: nil)%>
<%= turbo_frame_tag(dom_id(cv), target: :_top) do %>
  <%
    extra_class =  if change == :destroy
                     "min-h-[205px] destroyed-highlight"
                   elsif change == :create
                     "created-highlight"
                   else
                     ""
                   end
  %>
  <div class="cv-abstract my-2 flex justify-between p-2 rounded-xl border-2 border-gray-400 <%= extra_class %>">
    <div>
      <p class="text-lg font-semibold text-black">
        (ID: <%= cv.id.to_s %>)
      </p>
      <p class="text-lg font-semibold text-black">
        <% if cv.name.present? %>
          <%= cv.name %>
        <% else %>
          <span class="italic text-red-600">No Name given</span>
        <% end %>
      </p>
      <p class="font-medium text-gray-500"><%= truncate(cv.intro_line, length: 80) %></p>
      <p>
        <svg class="size-5 fill-gray-400 inline-block align-middle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M1.5 8.67v8.58a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V8.67l-8.928 5.493a3 3 0 0 1-3.144 0L1.5 8.67Z" />
          <path d="M22.5 6.908V6.75a3 3 0 0 0-3-3h-15a3 3 0 0 0-3 3v.158l9.714 5.978a1.5 1.5 0 0 0 1.572 0L22.5 6.908Z" />
        </svg>
        <% if cv.email_address.present? %>
          <span class="inline-block align-middle">
            <%= cv.email_address %>
          </span>
        <% else %>
          <span class="inline-block align-middle italic text-red-600">
            No Email Address given
          </span>
        <% end %>
      </p>
      <div class="flex flex-col mt-2 gap-2 sm:flex-row">
        <div class="pill">
          <span>
            Last Modified: <%= cv.updated_at.to_fs(:short) %>
          </span>
        </div>
        <% if cv.base_filename.present? %>
          <div class="pill">
            <svg class="size-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
            </svg>
            <span><%= cv.base_filename %>.*</span>
          </div>
        <% end %>

        <% if cv.language.present? %>
          <div class="pill">
            <svg class="size-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="m10.5 21 5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 0 1 6-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 0 1-3.827-5.802" />
            </svg>
            <span><%= cv.language %></span>
          </div>
        <% end %>
      </div>

      <% if cv.notes.present? %>
        <div class="mt-2">
          <p><strong>Notes:</strong> <%= simple_format cv.notes, class: "mb-3" %></p>
        </div>
      <% end %>
    </div>

    <% if change != :destroy %>
      <div class="flex flex-col justify-start content-stretch gap-2">
        <%= render partial: "layouts/controls/show",   locals: { cv: } %>
        <%= render partial: "layouts/controls/edit",   locals: { cv: } %>
        <%= render partial: "layouts/controls/copy",   locals: { cv: } %>
        <%= render partial: "layouts/controls/delete", locals: { cv: } %>
      </div>
    <% end %>
  </div>
<% end %>
